const bookSelect=document.querySelector("#book"),chapterSelect=document.querySelector("#chapter"),gridContainer=document.querySelector("#grid-container"),gridItemTemplate=document.querySelector("#grid-item-template"),addGridRowButton=document.querySelector("#add-grid-row"),bookChapters={Genesis:50,Exodus:40,Leviticus:27,Numbers:36,Deuteronomy:34,Joshua:24,Judges:21,Ruth:4,"1 Samuel":31,"2 Samuel":24,"1 Kings":22,"2 Kings":25,"1 Chronicles":29,"2 Chronicles":36,Ezra:10,Nehemiah:13,Esther:10,Job:42,Psalms:150,Proverbs:31,Ecclesiastes:12,"Song of Solomon":8,Isaiah:66,Jeremiah:52,Lamentations:5,Ezekiel:48,Daniel:12,Hosea:14,Joel:3,Amos:9,Obadiah:1,Jonah:4,Micah:7,Nahum:3,Habakkuk:3,Zephaniah:3,Haggai:2,Zechariah:14,Malachi:4,Matthew:28,Mark:16,Luke:24,John:21,Acts:28,Romans:16,"1 Corinthians":16,"2 Corinthians":13,Galatians:6,Ephesians:6,Philippians:4,Colossians:4,"1 Thessalonians":5,"2 Thessalonians":3,"1 Timothy":6,"2 Timothy":4,Titus:3,Philemon:1,Hebrews:13,James:5,"1 Peter":5,"2 Peter":3,"1 John":5,"2 John":1,"3 John":1,Jude:1,Revelation:22};let nextGridIndex=0;async function chapterOptions(e,t,r=null){t.value&&(window.chapterNumber=t.value),t.innerHTML="";for(let a=1;a<=e;a++){const e=document.createElement("option");e.value=a,e.textContent=a,(null!==r&&Number(r)===a||null===r&&window.chapterNumber&&window.chapterNumber==a)&&(e.selected=!0),t.appendChild(e)}}async function updateChapterSelect(){const e=bookSelect.value;chapterOptions(bookChapters[e],chapterSelect)}async function updateThisChapterSelect(e,t){const r=e.value;chapterOptions(bookChapters[r],t)}async function updateiframe(e,t,r,a){if("search"===e.dataset.gridMode)return;const o=encodeURIComponent(a.value),n=encodeURIComponent(t.value),i=encodeURIComponent(r.value);e.src=`/embed?version=${o}&book=${n}&chapter=${i}`}function assignGridIds(e,t){const r=e.querySelector('[data-grid-role="book-label"]'),a=e.querySelector('[data-grid-role="book"]'),o=e.querySelector('[data-grid-role="chapter-label"]'),n=e.querySelector('[data-grid-role="chapter"]'),i=e.querySelector('[data-grid-role="version-label"]'),d=e.querySelector('[data-grid-role="version"]'),c=e.querySelector('[data-grid-role="iframe"]');a&&(a.id=`book-${t}`,a.name="book"),n&&(n.id=`chapter-${t}`,n.name="chapter"),d&&(d.id=`version-selection-${t}`),c&&(c.id=`bible-frame-${t}`,c.title=`Bible frame ${t}`),r&&(r.setAttribute("for",`book-${t}`),r.setAttribute("aria-label",`Book selection ${t}`)),o&&(o.setAttribute("for",`chapter-${t}`),o.setAttribute("aria-label",`Chapter selection ${t}`)),i&&(i.setAttribute("for",`version-selection-${t}`),i.setAttribute("aria-label",`Version selection ${t}`)),e.dataset.gridIndex=t}function initGridItem(e){const t=e.querySelector('[data-grid-role="book"]'),r=e.querySelector('[data-grid-role="chapter"]'),a=e.querySelector('[data-grid-role="version"]'),o=e.querySelector('[data-grid-role="iframe"]');if(!(t&&r&&a&&o))return;updateThisChapterSelect(t,r),t.addEventListener("change",(async function(){updateThisChapterSelect(t,r)}));const n=async function(){updateiframe(o,t,r,a)};t.addEventListener("change",n),r.addEventListener("change",n),a.addEventListener("change",n)}function loadExistingGridItems(){if(!gridContainer)return;let e=-1;gridContainer.querySelectorAll("[data-grid-item]").forEach((t=>{const r=Number.parseInt(t.dataset.gridIndex,10);Number.isNaN(r)||(e=Math.max(e,r)),initGridItem(t)})),nextGridIndex=e+1}function createGridItem(e){if(!gridItemTemplate)return null;const t=gridItemTemplate.content.cloneNode(!0),r=t.querySelector("[data-grid-item]");if(!r)return null;assignGridIds(r,e);const a=r.querySelector('[data-grid-role="chapter"]'),o=r.querySelector('[data-grid-role="book"]');return o&&a&&chapterOptions(bookChapters[o.value],a,1),{fragment:t,itemRoot:r}}function createGridSpacer(){const e=document.createDocumentFragment();e.appendChild(document.createElement("br"));const t=document.createElement("span");return t.style.width="2%",t.innerHTML="&nbsp;",e.appendChild(t),e.appendChild(document.createElement("br")),e}function addGridRow(){if(!gridContainer)return;const e=document.createElement("div");e.className="container";const t=createGridItem(nextGridIndex);t&&(e.appendChild(t.fragment),initGridItem(t.itemRoot),nextGridIndex+=1),e.appendChild(createGridSpacer());const r=createGridItem(nextGridIndex);r&&(e.appendChild(r.fragment),initGridItem(r.itemRoot),nextGridIndex+=1),gridContainer.appendChild(e),gridContainer.appendChild(document.createElement("hr"))}function toggleSearchView(e){if(!gridContainer)return;const t=gridContainer.querySelector(`[data-grid-index="${e}"]`);if(!t)return;const r=t.querySelector('[data-grid-role="book"]'),a=t.querySelector('[data-grid-role="chapter"]'),o=t.querySelector('[data-grid-role="version"]'),n=t.querySelector('[data-grid-role="iframe"]');n&&r&&a&&o&&("search"===n.dataset.gridMode?(delete n.dataset.gridMode,updateiframe(n,r,a,o)):(n.dataset.gridMode="search",n.src="/search_embed"))}if(bookSelect){for(let e=0;e<bookSelect.length;e++)bookSelect.options[e].label===book&&(bookSelect.selectedIndex=e);bookSelect.addEventListener("change",updateChapterSelect),updateChapterSelect()}else if(gridContainer)try{loadExistingGridItems();gridContainer.querySelectorAll("[data-search-toggle]").forEach((e=>{e.addEventListener("click",(()=>{const t=Number.parseInt(e.dataset.gridIndex,10);Number.isNaN(t)||toggleSearchView(t)}))})),addGridRowButton&&addGridRowButton.addEventListener("click",addGridRow),button&&button.addEventListener("click",(()=>{gridContainer.querySelectorAll('[data-grid-role="iframe"]').forEach((e=>{try{e.contentWindow.document.querySelector("html").setAttribute("data-theme",currentThemeSetting)}catch(e){console.log(e)}}))}))}catch(e){console.log(e),console.log("Unable to get any navigation selectors.")}