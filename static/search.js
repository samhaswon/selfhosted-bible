const searchBox=document.getElementById("search-box"),searchResults=document.getElementById("search-results"),versionSelection=document.getElementById("version-selection");async function fetchSearchResults(e,t){return await fetch(`/search_endpoint/?query=${e}&version=${t}`).then((e=>e.json())).catch((e=>{console.log(e)}))}function updateResults(e){searchResults.innerHTML="";for(let t=0;t<e.length;t++){const n=e[t][0].substring(0,e[t][0].lastIndexOf(" ")),o=e[t][0].substring(e[t][0].lastIndexOf(" ")+1,e[t][0].indexOf(":")),s=encodeURIComponent(versionSelection.value),c=encodeURIComponent(n),l=encodeURIComponent(o),r=`/embed?version=${s}&book=${c}&chapter=${l}`,a=window.searchEmbed?r:`/goto/?version=${s}&book=${c}&chapter=${l}`,d=document.createElement("a");d.href=a,d.textContent=e[t][0];const u=document.createElement("li");u.appendChild(d),u.appendChild(document.createTextNode(` ${e[t][1]}`)),u.appendChild(document.createElement("br")),u.appendChild(document.createElement("br")),searchResults.appendChild(u)}}searchBox.addEventListener("input",(e=>{fetchSearchResults(searchBox.value,versionSelection.value).then((e=>{updateResults(e.results)})).catch((e=>{console.log(e)}))})),versionSelection.addEventListener("change",(e=>{const t=searchBox.value;if(!t.length)return;fetchSearchResults(t,versionSelection.value).then((e=>{updateResults(e.results)})).catch((e=>{console.log(e)}))}));